import { useValue } from 'startupjs'
import Modal from '../Modal'
import Button from '../Button'
import { Sandbox } from '@startupjs/docs'
import { useRef } from 'react'

# Modal (модалка)

Модалка может быть использована, когда пользователю необходимо сообщить о критической информации, требовать принятия решений или взаимодействовать со сложным подприложением без перехода на новую страницу или прерывания рабочего процесса.
Компонент Modal наследуется от [React Native Modal](https://reactnative.dev/docs/modal), вы можете использовать все его пропсы.

```jsx
import { Modal } from '@startupjs/ui'
```

## Пример

- `showCross` булевое значение, устанавливает отображение крестика в заголовке (по умолчанию `true`)
- `onCrossPress` колбек, который выполняется при нажатии на крестик в заголовке (он имеет более высокий приоритет чем `onCancel`)
- `onCancel` отображает кнопку отмены, которая использует этот обработчик
- `onConfirm` отображает кнопку подтверждения которая использует этот обработчик
- `enableBackdropPress` булевое значение, устанавливает будет ли область вокруг модалки кликабельной (по умолчанию `true`)
- `onBackdropPress` колбек, который выполняется при нажатии на область вокруг модалки
- `onRequestClose` колбек, который выполняется при нажатии физической клавиши `Домой` на Android, клавиши `Esc` в браузере (по умолчанию закрывает модалку)
- `onDismiss` колбек, который выполняется после закрытия модалки любым способом
- `onOrientationChange` колбек, который выполняется при смене ориентации мобильного устройства.

```jsx example
const [visible, $visible] = useValue(false)

return (
  <React.Fragment>
    <Button onPress={() => $visible.set(true)}>
      Открыть модалку
    </Button>
    <Modal
      title='Пример'
      $visible={$visible}
      dismissLabel='Закрыть'
      confirmLabel='Принять'
      onCrossPress={() => $visible.set(false)}
      onCancel={() => $visible.set(false)}
      onConfirm={() => $visible.set(false)}
      onShow={() => console.log('Modal shown!')}
      onBackdropPress={() => $visible.set(false)}
      onDismiss={() => console.log('onDismiss')}
      onRequestClose={() => $visible.set(false)}
    >
      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit.
    </Modal>
  </React.Fragment>
)
```

## Полноэкранная модалка

По умолчанию модалка отображается как окно в центре страницы. Чтобы сделать её полноэкранной, нужно передать строку `fullscreen` в свойство `variant`.

```jsx example
const [visible, $visible] = useValue(false)

return (
  <React.Fragment>
    <Button onPress={() => $visible.set(true)}>
      Открыть полноэкранную модалку
    </Button>
    <Modal
      variant='fullscreen'
      title='Полноэкранный пример'
      $visible={$visible}
      onCancel={() => $visible.set(false)}
      onConfirm={() => $visible.set(false)}
    >
      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit.
    </Modal>
  </React.Fragment>
)
```

## Неконтролируемая модалка

Вам не обязательно создавать свой `useValue` и передавать его сеттер в модалку. Для управления состоянием модалки вы можете завести переменную с `const modalRef = useRef()` и передавать её в модалку `ref={modalRef}`, а затем самим вызывать методы `open` и `close` у `modalRef.current` для управления состоянием модалки.

```jsx example
const modalRef = useRef()

return (
  <React.Fragment>
    <Button onPress={() => modalRef.current.open()}>
      Открыть неконтролируемую модалку
    </Button>
    <Modal
      ref={modalRef}
      title='Неконтролируемая модалка'
    >
      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit.
    </Modal>
  </React.Fragment>
)
```

## Продвинутое использование

Модалка состоит из трех частей - `Header`, `Content` и `Actions`. Эти части можно использовать для добавления пользовательской разметки, `Header` используется вместо `title`, `Content` используется вместо `children` и `Actions` используется вместо обработчиков `onCancel`, `onConfirm`. Их можно использовать по отдельности.

```jsx example
const [visible, $visible] = useValue(false)

return (
  <React.Fragment>
    <Button onPress={() => $visible.set(true)}>
      Open advanced modal
    </Button>
    <Modal $visible={$visible}>
      <Modal.Header>Advanced modal</Modal.Header>
      <Modal.Content>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit.
      </Modal.Content>
      <Modal.Actions>
        <Button
          shape='circle'
          onPress={() => $visible.set(false)}
        >
          Custom close
        </Button>
        <Button
          pushed
          shape='circle'
          onPress={() => $visible.set(false)}
        >
          Custom confirm
        </Button>
      </Modal.Actions>
    </Modal>
  </React.Fragment>
)
```

## Sandbox

### Modal

<Sandbox Component={Modal} />

### Modal.Header

<Sandbox Component={Modal.Header} />

### Modal.Content

<Sandbox Component={Modal.Content} />

### Modal.Actions

<Sandbox Component={Modal.Actions} />
